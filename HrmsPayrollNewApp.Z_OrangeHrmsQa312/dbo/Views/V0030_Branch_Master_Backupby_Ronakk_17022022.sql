



 
Create VIEW [dbo].[V0030_Branch_Master_Backupby_Ronakk_17022022]  
AS  
SELECT     dbo.T0030_BRANCH_MASTER.Branch_Name, dbo.T0030_BRANCH_MASTER.Branch_Address, upper(dbo.T0030_BRANCH_MASTER.Branch_City) as Branch_City,   
upper(dbo.T0020_STATE_MASTER.State_Name) as State_Name , dbo.T0030_BRANCH_MASTER.Branch_ID, dbo.T0030_BRANCH_MASTER.Cmp_ID,   
dbo.T0030_BRANCH_MASTER.State_ID, dbo.T0030_BRANCH_MASTER.Branch_Code, dbo.T0030_BRANCH_MASTER.Comp_Name,   
dbo.T0030_BRANCH_MASTER.Is_Contractor_Branch, dbo.T0030_BRANCH_MASTER.Branch_Default, dbo.T0010_COMPANY_MASTER.Cmp_Name,   
dbo.T0030_BRANCH_MASTER.Location_ID, dbo.T0001_LOCATION_MASTER.Loc_name,  
dbo.T0030_BRANCH_MASTER.PT_RC_No,dbo.T0030_BRANCH_MASTER.PT_Zone,dbo.T0030_BRANCH_MASTER.PT_Ward_No,dbo.T0030_BRANCH_MASTER.PT_Census_No  
,dbo.T0030_BRANCH_MASTER.IsActive,dbo.T0030_BRANCH_MASTER.InActive_EffeDate   
,dbo.T0030_BRANCH_MASTER.PF_No,dbo.T0030_BRANCH_MASTER.ESIC_No,
CASE WHEN dbo.T0030_BRANCH_MASTER.IsActive=1 THEN 'awards_link'	
WHEN dbo.T0030_BRANCH_MASTER.IsActive=0 THEN 'awards_link clsinactive' ELSE 'awards_link clsinactive' END  as Status_Color
,Contr_PersonName ,Contr_Email ,Contr_MobileNo ,Contr_Aadhaar ,Contr_GSTNumber ,Nature_Of_Work ,No_Of_LabourEmployed ,Date_Of_Commencement ,Date_Of_Termination ,Vendor_Code,Contr_Det_ID
FROM dbo.T0030_BRANCH_MASTER WITH (NOLOCK) INNER JOIN  
dbo.T0010_COMPANY_MASTER WITH (NOLOCK)  ON dbo.T0030_BRANCH_MASTER.Cmp_ID = dbo.T0010_COMPANY_MASTER.Cmp_Id LEFT OUTER JOIN  
dbo.T0001_LOCATION_MASTER WITH (NOLOCK)  ON dbo.T0030_BRANCH_MASTER.Location_ID = dbo.T0001_LOCATION_MASTER.Loc_ID LEFT OUTER JOIN  
dbo.T0020_STATE_MASTER WITH (NOLOCK)  ON dbo.T0030_BRANCH_MASTER.State_ID = dbo.T0020_STATE_MASTER.State_ID  AND T0030_BRANCH_MASTER.Cmp_ID = T0020_STATE_MASTER.Cmp_ID
Left Outer join (SELECT CDM.* FROM dbo.T0035_CONTRACTOR_DETAIL_MASTER CDM  WITH (NOLOCK) 
					INNER JOIN (SELECT MAX(DATE_OF_COMMENCEMENT) AS DOC, BRANCH_ID 
								FROM T0035_CONTRACTOR_DETAIL_MASTER  WITH (NOLOCK) 
								GROUP BY Branch_ID) QRY ON CDM.BRANCH_ID = QRY.BRANCH_ID AND CDM.Date_Of_Commencement = QRY.DOC) CONTR 
								ON T0030_BRANCH_MASTER.Branch_ID = CONTR.Branch_ID
